# kotlin-convenience-store-precourse

markdown
코드 복사

# 기능 요구 명세서

## 1. 최종 결제 금액 계산

- **목적**: 구매자의 할인 혜택과 재고 상황을 고려하여 최종 결제 금액을 정확히 계산하여 안내한다.
- **기능 설명**:
    - 상품 가격과 수량을 곱하여 기본 총구매액을 계산한다.
    - 프로모션 및 멤버십 할인 정책을 적용하여 최종 결제 금액을 산출한다.
    - 계산한 최종 결제 금액은 영수증을 통해 출력한다.

## 2. 입력 처리

- **목적**: 사용자에게 상품 목록을 입력받고 오류가 발생하면 명확한 에러 메시지와 함께 재입력 요청을 한다.
- **세부 내용**:
    - 상품명과 수량을 대괄호 `[]`로 묶고, 상품과 수량은 하이픈 `-`으로 구분하여 입력받는다. 상품은 쉼표 `,`로 구분한다.
    - 프로모션 상품 추가 여부와 멤버십 할인 적용 여부, 추가 구매 여부도 입력받는다.
    - **오류 처리**: 잘못된 값이 입력되면 `IllegalArgumentException`을 발생시키고, `[ERROR]` 메시지로 시작하는 에러 메시지를 출력한 뒤 다시 입력을 받는다.

## 3. 재고 관리

- **목적**: 구매 시 실시간으로 재고를 갱신하여 최신 재고 상황을 유지한다.
- **기능 설명**:
    - 상품 구매 시 재고가 충분한지 확인하고, 결제된 수량만큼 재고를 차감한다.
    - 재고가 부족하면 결제를 진행할 수 없으며, 부족한 재고 수량에 대해 안내한다.
    - 프로모션 재고와 일반 재고를 구분하여 관리한다.

## 4. 프로모션 할인

- **목적**: 특정 상품에 대해 지정된 프로모션 할인(예: 1+1, 2+1)을 적용한다.
- **기능 설명**:
    - 오늘 날짜가 프로모션 기간 내에 포함된 경우 프로모션을 적용한다.
    - 구매한 수량이 프로모션 조건(N개 구매 시 1개 무료)에 부합할 때만 적용된다.
    - 사용자가 필요한 수량보다 적게 가져온 경우 추가 여부를 묻고, 응답에 따라 증정 상품 추가 여부를 결정한다.
    - **프로모션 재고**: 프로모션 적용 시, 우선적으로 프로모션 재고를 차감하며, 부족한 경우 일반 재고를 사용한다.
    - 일부 수량에 대해 프로모션을 적용하지 못하는 경우 정가 결제를 진행할지 여부를 묻는다.

## 5. 멤버십 할인

- **목적**: 프로모션 할인 후 남은 금액에 대해 멤버십 할인을 적용한다.
- **할인 규칙**:
    - 멤버십 회원은 프로모션 미적용 금액의 30%를 할인받으며, 최대 할인 금액은 8,000원이다.
    - 멤버십 할인이 적용된 최종 금액을 산출하여 출력한다.

## 6. 영수증 출력

- **목적**: 사용자가 이해하기 쉽게 결제 내역과 할인 내역을 정리하여 출력한다.
- **구성 요소**:
    - **구매 상품 내역**: 구매한 상품명, 수량, 가격을 포함하여 출력한다.
    - **증정 상품 내역**: 프로모션으로 무료로 제공된 상품과 수량을 출력한다.
    - **금액 정보**:
        - 총구매액: 구매한 상품의 총 수량과 총 금액
        - 행사할인: 프로모션 할인된 금액
        - 멤버십할인: 멤버십에 의해 추가로 할인된 금액
        - 내실돈: 최종 결제 금액
    - 영수증 항목을 정렬하여 금액과 수량을 명확히 확인할 수 있도록 한다.

## 7. 추가 구매 여부

- **목적**: 추가 구매를 통해 사용자가 재고가 업데이트된 상품 목록을 확인하고 추가 결제를 진행할 수 있도록 한다.
- **세부 내용**:
    - 영수증 출력 후, 추가 구매 여부를 묻는다.
        - `Y`: 추가 구매 진행 시, 갱신된 재고 정보를 기준으로 상품 목록을 확인하고 구매를 계속할 수 있다.
        - `N`: 구매를 종료한다.

## 8. 입출력 처리

- **파일 입출력**:
    - 상품 목록과 행사 목록은 `src/main/resources/products.md`와 `src/main/resources/promotions.md` 파일에서 불러온다.
    - 파일의 형식이 유지되면, 내용을 수정하여 데이터를 업데이트할 수 있다.
